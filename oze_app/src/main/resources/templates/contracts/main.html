<!DOCTYPE html>
<html lang="en" layout:decorate="~{layout/public}" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<head>
    <title>Contract</title>
</head>
<body style="background: #DDD">
<main layout:fragment="_main" class="contracts">
    <input type="hidden" th:value="${hiddenId}" id="hiddenId">
    <div class="container" style="background: #FFF; margin-top: 30px; padding-bottom: 10px; margin-bottom: 10px;">

        <h3>Heat Pumps</h3>
        <div id="heat-pumps-wrapper"
             class="product-list-large"
             th:insert="~{fragments/contracts :: add-row('#modal-heat-pump')}"
        ></div>

        <h3>CWU Tanks</h3>
        <div id="cwu-wrapper"
             class="product-list-large"
             th:insert="~{fragments/contracts :: add-row('#modal-cwu')}"
        ></div>

        <h3>CO Buffers</h3>
        <div id="co-wrapper"
             class="product-list-large"
             th:insert="~{fragments/contracts :: add-row('#modal-co')}"
        ></div>

        <h3>Miscellaneous</h3>
        <div id="other-wrapper"
             class="product-list-large"
             th:insert="~{fragments/contracts :: add-row('#modal-other')}"
        ></div>

    </div>
</main>
<th:block layout:fragment="before-footer">
    <template id="template-custom-item">
        <div class="custom-item">
            <div class="split-flex">
                <div class="image">
                    <a>
                        <img src="" alt="product-image">
                    </a>
                </div>
                <div class="details">
                    <div class="detail-grid">
                        <div class="title-tile"></div>
                        <div class="price-tile">
                            <span class="price"></span>
                        </div>
                        <div class="detail-tile">
                            <div id="custom-item-description-placeholder"></div>
                            <div class="quantity">
                                <span>Quantity:</span>
                                <input class="form-control" type="number" name="itemQuantity" />
                            </div>
                        </div>
                        <div class="actions-tile">
                            <div class="d-flex actions">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     class="bi bi-pencil-square" viewBox="0 0 16 16">
                                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z" />
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" class="bi bi-trash3"
                                     viewBox="0 0 16 16"
                                     onclick="deleteProduct(this)"
                                >
                                    <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Heat Pump Modal -->
    <div class="modal fade" id="modal-heat-pump" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Heat Pump</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="add-heat-pump-modal-form">
                        <div class="col-md-12">
                            <label for="modal-heat-pumps_manufacturer" class="form-label">Manufacturer</label>
                            <select id="modal-heat-pumps_manufacturer"
                                    class="form-select"
                                    name="manufacturer"
                                    required
                                    hx-get="/contracts/add-heat-pump"
                                    hx-swap="outerHTML"
                                    hx-target="#modal-heat-pumps_modelId"
                                    hx-include="#modal-heat-pumps_typeId[name='typeId']"
                            >
                                <option selected value="" label="All"></option>
                                <option th:each="brand : ${heatPumpBrands}" th:value="${brand}" th:text="${brand}"></option>
                            </select>
                        </div>
                        <div class="col-md-12">
                            <label for="modal-heat-pumps_typeId" class="form-label">Type</label>
                            <select id="modal-heat-pumps_typeId"
                                    class="form-select"
                                    name="typeId"
                                    required
                                    hx-get="/contracts/add-heat-pump"
                                    hx-swap="outerHTML"
                                    hx-target="#modal-heat-pumps_modelId"
                                    hx-include="#modal-heat-pumps_manufacturer[name='manufacturer']"
                            >
                                <option selected value="" label="All"></option>
                                <option th:each="t : ${heatPumpTypes}" th:value="${t.getId()}" th:text="${t.getName()}"></option>
                            </select>
                        </div>
                        <div class="col-md-12">
                            <label for="modal-heat-pumps_modelId" class="form-label">Model</label>
                            <select class="form-select" id="modal-heat-pumps_modelId" name="modelId" required>
                                <option selected value="0" label="..."></option>
                                <option th:each="m : ${heatPumpModels}" th:value="${m.id}" th:text="${m.model}"></option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="handleAddModalSubmitHeatPump()">Add</button>
                </div>
            </div>
        </div>
    </div>
    <!-- TODO edit heatpump/etc -->

    <!-- CWU Modal -->
    <div class="modal fade" id="modal-cwu" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add CWU</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="add-cwu-modal-form">
                        <div class="col-md-12">
                            <label for="modal-cwu_manufacturer" class="form-label">Manufacturer</label>
                            <select id="modal-cwu_manufacturer"
                                    class="form-select"
                                    name="manufacturer"
                                    required
                                    hx-get="/contracts/add-cwu"
                                    hx-swap="outerHTML"
                                    hx-target="#modal-cwu_modelId"
                            >
                                <option selected value="" label="All"></option>
                                <option th:each="brand : ${cwuBrands}" th:value="${brand}" th:text="${brand}"></option>
                            </select>
                        </div>
                        <div class="col-md-12">
                            <label for="modal-cwu_modelId" class="form-label">Model</label>
                            <select class="form-select" id="modal-cwu_modelId" name="modelId" required>
                                <option disabled selected value="" label="..."></option>
                                <option th:each="m : ${cwuModels}" th:value="${m.id}" th:text="${m.model}"></option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="handleAddModalSubmitCwu()">Add</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CO Modal -->
    <div class="modal fade" id="modal-co" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add CO</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="add-co-modal-form">
                        <div class="col-md-12">
                            <label for="modal-co_manufacturer" class="form-label">Manufacturer</label>
                            <select id="modal-co_manufacturer"
                                    class="form-select"
                                    name="manufacturer"
                                    required
                                    hx-get="/contracts/add-co"
                                    hx-swap="outerHTML"
                                    hx-target="#modal-co_modelId"
                            >
                                <option selected value="" label="All"></option>
                                <option th:each="brand : ${coBrands}" th:value="${brand}" th:text="${brand}"></option>
                            </select>
                        </div>
                        <div class="col-md-12">
                            <label for="modal-co_modelId" class="form-label">Model</label>
                            <select class="form-select" id="modal-co_modelId" name="modelId" required>
                                <option disabled selected value="" label="..."></option>
                                <option th:each="m : ${coModels}" th:value="${m.id}" th:text="${m.model}"></option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="handleAddModalSubmitCo()">Add</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Misc Products -->
    <div class="modal fade" id="modal-other" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Other Product</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="add-other-modal-form">
                        <div class="col-md-12">
                            <label for="modal-other_type" class="form-label">Type</label>
                            <select id="modal-other_type"
                                    class="form-select"
                                    name="type"
                                    required
                                    hx-get="/contracts/add-other"
                                    hx-swap="outerHTML"
                                    hx-target="#modal-other_modelId"
                            >
                                <option selected value="" label="All"></option>
                                <option th:each="t : ${otherProductTypes}" th:value="${t.id}" th:text="${t.name}"></option>
                            </select>
                        </div>
                        <div class="col-md-12">
                            <label for="modal-other_modelId" class="form-label">Model</label>
                            <select class="form-select" id="modal-other_modelId" name="modelId" required>
                                <option disabled selected value="" label="..."></option>
                                <option th:each="m : ${otherModels}" th:value="${m.id}" th:text="${m.model}"></option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="handleAddModalSubmitOther()">Add</button>
                </div>
            </div>
        </div>
    </div>
</th:block>
<th:block layout:fragment="_end">
<script th:src="@{/js/contract.js}"></script>
</th:block>
</body>
</html>